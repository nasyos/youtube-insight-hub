# OAuth設定 - localhost問題の解決方法

## ❓ 問題1: アプリケーションのホームページにlocalhostを入力できない

### エラーメッセージ
```
無効なドメイン: 空白文字を含めることはできません
```

### 解決方法

**開発環境では、アプリケーションのホームページを空欄のままにしても問題ありません。**

### 手順

1. **アプリケーションのホームページフィールドを空欄にする**
   - `http://localhost:3000` を削除
   - 空欄のままにする

2. **プライバシーポリシーと利用規約も空欄のまま**
   - 開発環境では不要です

3. **保存**
   - 空欄のまま保存できます

### 重要なポイント

- **OAuth同意画面の「アプリケーションのホームページ」は開発環境では必須ではありません**
- **実際に重要なのは、OAuth 2.0クライアントIDの設定で「承認済みのリダイレクトURI」に `http://localhost:3000` を設定することです**
- これは後でOAuth 2.0クライアントIDを作成する際に設定します

---

## ❓ 問題2: 概要ページでスコープのセクションが見つからない

### 原因

スコープは、**OAuth 2.0クライアントIDを作成した後**に設定する場合があります。

### 解決方法

#### 方法1: OAuth 2.0クライアントIDを作成してからスコープを設定

1. **まずOAuth 2.0クライアントIDを作成**
   - 「認証情報」ページに移動
   - 「+ 認証情報を作成」→「OAuth 2.0 クライアントID」を選択
   - クライアントIDを作成

2. **クライアントIDの編集画面でスコープを設定**
   - 作成したクライアントIDをクリック
   - 編集画面でスコープを設定できる場合があります

#### 方法2: OAuth同意画面の設定でスコープを追加（推奨）

実は、**スコープはOAuth同意画面の設定で自動的に追加される場合があります**。

1. **OAuth 2.0クライアントIDを作成**
   - クライアントIDを作成する際に、アプリが使用するスコープを自動的に検出します

2. **アプリが実際にスコープを要求する**
   - アプリ内でGoogle認証を実行すると、必要なスコープが自動的に追加されます

#### 方法3: 手動でスコープを追加（必要に応じて）

1. **「APIとサービス」→「OAuth同意画面」に戻る**
2. **「スコープ」タブまたはセクションを探す**
   - ページ内をスクロールして「スコープ」セクションを探す
   - または、上部のタブに「スコープ」がある場合があります

3. **「スコープを追加または削除」をクリック**
4. **必要なスコープを検索して追加**

---

## 🎯 推奨される手順（簡略版）

### ステップ1: OAuth同意画面の基本設定

1. **ブランディングページ**
   - アプリ名: `YouTube Insight Hub`（既に入力済み）
   - ユーザーサポートメール: 自分のメールアドレス（既に入力済み）
   - **アプリケーションのホームページ: 空欄のまま**（localhostは入力しない）
   - プライバシーポリシー: 空欄のまま
   - 利用規約: 空欄のまま
   - **保存**

2. **対象ページ**
   - 「+ Add users」ボタンでテストユーザーを追加
   - **保存**

### ステップ2: OAuth 2.0クライアントIDを作成

1. **「認証情報」ページに移動**
   - 左側のメニューから「APIとサービス」→「認証情報」をクリック

2. **「+ 認証情報を作成」→「OAuth 2.0 クライアントID」を選択**

3. **設定**
   - アプリケーションの種類: 「ウェブアプリケーション」
   - 名前: `YouTube Insight Hub - Local Development`
   - **承認済みのJavaScript生成元**: `http://localhost:3000`
   - **承認済みのリダイレクトURI**: `http://localhost:3000`
   - **作成**

4. **Client IDをコピー**

### ステップ3: 必要なAPIを有効化

1. **「APIとサービス」→「ライブラリ」を開く**
2. **以下のAPIを有効化**:
   - Google Drive API
   - Google Docs API

### ステップ4: アプリ内で認証をテスト

1. **アプリの「連携設定」でClient IDを入力**
2. **「Googleと連携する」をクリック**
3. **認証が成功すると、必要なスコープが自動的に追加されます**

---

## ⚠️ 重要なポイント

### localhostについて

- **OAuth同意画面の「アプリケーションのホームページ」は空欄のままでも問題ありません**
- **重要なのは、OAuth 2.0クライアントIDの「承認済みのリダイレクトURI」に `http://localhost:3000` を設定することです**

### スコープについて

- **スコープは、アプリが実際にGoogle認証を実行した際に自動的に追加される場合があります**
- **または、OAuth 2.0クライアントIDを作成した後、クライアントの編集画面で設定できます**
- **開発環境では、テストユーザーが追加されていれば、スコープの手動追加は必須ではありません**

---

## ✅ 確認チェックリスト

- [ ] ブランディングページで「アプリケーションのホームページ」を空欄のまま保存
- [ ] 対象ページでテストユーザーを追加
- [ ] OAuth 2.0クライアントIDを作成（承認済みのリダイレクトURIに `http://localhost:3000` を設定）
- [ ] Google Drive APIとGoogle Docs APIを有効化
- [ ] アプリ内で認証をテスト

---

## 🎯 次のステップ

1. **ブランディングページで「アプリケーションのホームページ」を空欄にして保存**
2. **対象ページでテストユーザーを追加**
3. **OAuth 2.0クライアントIDを作成**

これで設定を進められます！

