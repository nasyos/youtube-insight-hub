# 次のステップ - Google認証完了後

## ✅ 完了したこと

- ✅ Google OAuth認証が完了
- ✅ Google Drive APIとGoogle Docs APIへのアクセス権限が付与された

---

## 🎯 次のステップ: 動画スキャン機能のテスト

### ステップ1: 動画スキャンの実行

**前提条件**: 
- ✅ Google認証が完了している
- ✅ チャンネルが1つ以上追加されている（例: `@programming_tutorial_youtube`）

**手順**:

1. **アプリの「最新をチェック」ボタンをクリック**
   - 画面下部の大きな青いボタンです

2. **期待される動作**:
   - [ ] 「スキャン中...」と表示される
   - [ ] 数秒〜数十秒待つ（Gemini APIの処理時間）
   - [ ] 新しい要約カードが表示される
   - [ ] 各要約カードに「📄 要約をGoogleドキュメントで見る」ボタンが表示される

3. **確認項目**:
   - [ ] スキャンが正常に完了する
   - [ ] エラーメッセージが表示されない
   - [ ] 新しい要約が表示される

---

## 📄 ステップ2: Googleドキュメント作成の確認

### 2.1 自動保存の確認

動画スキャンが完了すると、**自動的にGoogleドキュメントが作成されます**。

**確認方法**:

1. **Google Driveで確認**
   - [Google Drive](https://drive.google.com) にアクセス
   - 「YouTube Insight Hub」フォルダを探す（自動的に作成される）
   - フォルダ内に要約ドキュメントが保存されていることを確認

2. **アプリ内で確認**
   - 要約カードの「📄 要約をGoogleドキュメントで見る」ボタンをクリック
   - Googleドキュメントが開くことを確認
   - ドキュメントに以下が含まれていることを確認：
     - ✅ 動画のタイトル
     - ✅ チャンネル名
     - ✅ 公開日
     - ✅ 要約文（200文字程度）
     - ✅ 重要なポイント（3つ）

### 2.2 ドキュメント内容の確認

1. **Googleドキュメントを開く**
   - 要約カードの「📄 要約をGoogleドキュメントで見る」ボタンをクリック

2. **確認項目**:
   - [ ] ドキュメントが正しく開く
   - [ ] タイトル、チャンネル名、公開日が表示される
   - [ ] 要約文が表示される
   - [ ] 重要なポイントが表示される

---

## 💬 ステップ3: Google Chat通知のテスト（オプション）

### 3.1 Google Chat Webhook URLの取得

1. [Google Chat](https://chat.google.com) にアクセス
2. 通知を受け取りたいスペース（チャットルーム）を開く
3. スペース名の横の「⋮」（三点メニュー）をクリック
4. 「アプリと統合」→「Webhookを管理」を選択
5. 「Webhookを追加」をクリック
6. Webhook名を入力（例: `YouTube Insight Hub`）
7. 「保存」をクリック
8. **Webhook URL** をコピー（例: `https://chat.googleapis.com/v1/spaces/XXXXX/messages?key=YYYYY&token=ZZZZZ`）

### 3.2 アプリ内での設定

1. **アプリの「GOOGLE CHAT通知」セクションで設定**
   - Webhook URLを入力
   - 「新しい要約を自動的にGoogle Chatに通知」にチェックを入れる
   - 設定が保存されることを確認

### 3.3 通知のテスト

1. **新しい要約を生成**
   - 「最新をチェック」をクリック
   - 新しい要約が生成される

2. **確認項目**:
   - [ ] Google Chatのスペースに通知が送信される
   - [ ] 通知に以下が含まれる：
     - ✅ 動画のタイトル
     - ✅ チャンネル名
     - ✅ Googleドキュメントへのリンク
     - ✅ 動画URL（オプション）

---

## ⚠️ トラブルシューティング

### 問題1: スキャンが実行されない

**症状**: 「最新をチェック」をクリックしても何も起こらない

**確認項目**:
1. Google認証が完了しているか（Session Storageに `google_access_token` があるか）
2. チャンネルが追加されているか
3. コンソールにエラーメッセージが表示されていないか

**解決方法**:
- 開発者ツール（F12）のコンソールでエラーを確認
- Google認証を再度実行

### 問題2: Googleドキュメントが作成されない

**症状**: スキャンは成功するが、Googleドキュメントが作成されない

**確認項目**:
1. Google認証が完了しているか
2. Google Drive APIとGoogle Docs APIが有効化されているか
3. コンソールにエラーメッセージが表示されていないか

**解決方法**:
- Google Cloud ConsoleでAPIの有効化を確認
- Google認証を再度実行

### 問題3: Google Chat通知が送信されない

**症状**: 要約は生成されるが、Google Chatに通知が届かない

**確認項目**:
1. Webhook URLが正しく入力されているか
2. 「新しい要約を自動的にGoogle Chatに通知」にチェックが入っているか
3. Google ChatのWebhookが有効か

**解決方法**:
- Webhook URLを再確認
- Google ChatのWebhook設定を確認

---

## ✅ 完了チェックリスト

すべてのテストが完了したら、以下を確認：

- [ ] 動画スキャン機能が正常に動作する
- [ ] Googleドキュメントが自動的に作成される
- [ ] Google Driveに「YouTube Insight Hub」フォルダが作成される
- [ ] 要約ドキュメントの内容が正しく表示される
- [ ] Google Chat通知が正常に送信される（設定済みの場合）
- [ ] データベースにデータが正しく保存される

---

## 🎯 次のステップ

すべての機能が正常に動作している場合：

1. **定期クローリング機能の実装**（フェーズ3）
   - Vercel Cron Jobsを使用した自動スキャン
   - 所要時間: 3-4時間

2. **Webhook機能の実装**（フェーズ4）
   - YouTube PubSubHubbubを使用したリアルタイム通知
   - 所要時間: 4-5時間

3. **Vercelへのデプロイ**
   - 本番環境へのデプロイ
   - 環境変数の設定

---

## 📝 参考

- 詳細なテスト手順: `テスト手順書_Google連携.md`
- 実装計画: `実装計画.md`


